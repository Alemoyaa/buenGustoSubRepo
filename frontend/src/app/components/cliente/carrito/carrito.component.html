<div class="page shopping-cart-page">
  <section class="clean-block clean-cart dark">
    <div class="container">
      <div class="block-heading">
        <h2 class="text-info" *ngIf="listaDetallePedido.length !== 0">
          Factura
        </h2>
        <h3 *ngIf="listaDetallePedido.length === 0">
          El carrito está vacío
        </h3>
      </div>
      <div class="content">
        <div class="row no-gutters">
          <div class="col-md-12 col-lg-8">
            <div class="items">
              <div
                class="product"
                *ngFor="
                  let detallePedidoItem of listaDetallePedido;
                  let i = index
                "
              >
                <button type="button" class="btn" (click)="deleteArticulo(i)">
                  <svg
                    width="1em"
                    height="1em"
                    viewBox="0 0 16 16"
                    class="bi bi-archive"
                    fill="currentColor"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M2 5v7.5c0 .864.642 1.5 1.357 1.5h9.286c.715 0 1.357-.636 1.357-1.5V5h1v7.5c0 1.345-1.021 2.5-2.357 2.5H3.357C2.021 15 1 13.845 1 12.5V5h1z"
                    />
                    <path
                      fill-rule="evenodd"
                      d="M5.5 7.5A.5.5 0 0 1 6 7h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1-.5-.5zM15 2H1v2h14V2zM1 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H1z"
                    />
                  </svg>
                </button>
                <div
                  class="row justify-content-center align-items-center"
                  *ngIf="
                    detallePedidoItem.articuloInsumo;
                    else elseArticuloManufacturado
                  "
                >
                  <div class="col-md-3">
                    <div class="product-image">
                      <img
                        width="100px"
                        class="img-fluid d-block mx-auto image"
                        src="{{ detallePedidoItem.articuloInsumo.url_imagen }}"
                      />
                    </div>
                  </div>
                  <div class="col-md-5 product-info">
                    <h5 class="product-name">
                      {{ detallePedidoItem.articuloInsumo.denominacion }}
                    </h5>
                    <div class="product-specs">
                      <div>
                        <span><b>$</b>&nbsp;</span>
                        <span class="value">
                          <b>
                            {{
                              detallePedidoItem.articuloInsumo.precio_de_venta
                            }}</b
                          >
                        </span>
                      </div>
                    </div>
                  </div>

                  <div class="col-6 col-md-2 quantity">
                    <label class="d-none d-md-block" for="quantity"
                      >Cantidad</label
                    ><input
                      type="number"
                      id="number"
                      min="1"
                      class="form-control quantity-input"
                      [(ngModel)]="detallePedidoItem.cantidad"
                      value="detallePedidoItem.cantidad"
                      disabled
                    />
                  </div>

                  <label class="mt-2">
                    <strong>Aclaracion</strong>
                  </label>
                  <input
                    class="form-control"
                    type="text"
                    placeholder="Aclaracion"
                    name="aclaracion"
                    [(ngModel)]="detallePedidoItem.aclaracion"
                  />
                </div>

                <ng-template
                  #elseArticuloManufacturado
                  class="row justify-content-center align-items-center"
                >
                  <div class="col-md-3">
                    <div class="product-image">
                      <img
                        width="100px"
                        class="img-fluid d-block mx-auto image"
                        src="{{
                          detallePedidoItem.articuloManufacturado.url_imagen
                        }}"
                      />
                    </div>
                  </div>
                  <div class="col-md-5 product-info">
                    <h5 class="product-name">
                      {{ detallePedidoItem.articuloManufacturado.denominacion }}
                    </h5>
                    <div class="product-specs">
                      <div>
                        <span><b>$</b>&nbsp;</span>
                        <span class="value">
                          <b>
                            {{
                              detallePedidoItem.articuloManufacturado
                                .precio_de_venta
                            }}</b
                          >
                        </span>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-2 quantity">
                    <label class="d-none d-md-block" for="quantity"
                      >Cantidad</label
                    ><input
                      type="number"
                      id="number"
                      min="1"
                      class="form-control quantity-input"
                      [(ngModel)]="detallePedidoItem.cantidad"
                      value="detallePedidoItem.cantidad"
                      disabled
                    />
                    <label class="mt-2">
                      <strong>Aclaracion</strong>
                    </label>
                    <input
                      class="form-control"
                      type="text"
                      placeholder="Aclaracion"
                      name="aclaracion"
                      [(ngModel)]="detallePedidoItem.aclaracion"
                    />
                  </div>
                </ng-template>
                <div class="botones">
                  <button
                    type="button"
                    class="btn btn-danger mr-3"
                    data-toggle="modal"
                    (click)="reducirArticulo(i)"
                  >
                    <svg
                      class="bi bi-dash-circle-fill"
                      width="1em"
                      height="1em"
                      viewBox="0 0 16 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4 7.5a.5.5 0 0 0 0 1h8a.5.5 0 0 0 0-1H4z"
                      />
                    </svg>
                  </button>
                  <button
                    (click)="addArticulo(i)"
                    type="button"
                    class="btn btn-success"
                    data-toggle="modal"
                  >
                    <svg
                      class="bi bi-plus-circle-fill"
                      width="1em"
                      height="1em"
                      viewBox="0 0 16 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4a.5.5 0 0 0-1 0v3.5H4a.5.5 0 0 0 0 1h3.5V12a.5.5 0 0 0 1 0V8.5H12a.5.5 0 0 0 0-1H8.5V4z"
                      />
                    </svg>
                  </button>
                </div>
              </div>
              <div class="center justify-content-center d-flex">
                <a [routerLink]="['/catalogo']">
                  <button type="button" class="btn btn-primary mr-3">
                    <p>Seguir comprando</p>
                  </button>
                </a>

                <h2 *ngIf="!checkearHorario">
                  El local se encuentra cerrado
                </h2>

                <button
                  *ngIf="
                    this.checkearHorario && listaDetallePedido.length !== 0
                  "
                  type="button"
                  class="btn btn-success"
                  data-toggle="modal"
                  data-target="#paymentModal"
                >
                  <p>Pagar</p>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Modal -->
  <div
    class="modal fade"
    id="paymentModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="paymentModal"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="paymentModal">Confirmación</h5>
          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <h3>Total: {{ total }}</h3>
          <div class="form-check mt-2">
            <input type="checkbox" [(ngModel)]="envio" />
            <label class="form-check-label ml-3">Envio a domicilio</label>
            <label class="form-check-label ml-3">
              Si el pedido es retirado en el local, obtendra un
              <strong>10% de descuento</strong> en su factura
            </label>
          </div>
          <hr />
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="pago"
              id="pago1"
              value="pagoOption1"
              checked
              (click)="setPago('0')"
            />
            <label class="form-check-label ml-3" for="exampleRadios1">
              <p>Efectivo</p>
            </label>
          </div>
          <div class="form-check" *ngIf="!envio">
            <input
              class="form-check-input"
              type="radio"
              name="pago"
              id="pago2"
              value="pagoOption2"
              (click)="setPago('1')"
            />
            <label class="form-check-label ml-3" for="exampleRadios2">
              <p>Otro medio de pago</p>
            </label>
          </div>
          <hr />
          <div class="metodoDePago" *ngIf="otroMedioDePago && !envio">
            <p><label for="cars">Elegir método de pago</label></p>

            <select [(ngModel)]="factura.formaPago" name="pago" id="medioPago">
              <option value="Debito">
                <p>Débito</p>
              </option>
              <option value="Credito">
                <p>Crédito</p>
              </option>
            </select>
            <br />
            <label>Ingrese su numero de tarjeta</label>
            <input type="text" [(ngModel)]="factura.nroTarjeta" />
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            <p>Cerrar</p>
          </button>
          <button
            (click)="pagar()"
            type="button"
            class="btn btn-primary"
            data-dismiss="modal"
          >
            <p>Comprar</p>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
